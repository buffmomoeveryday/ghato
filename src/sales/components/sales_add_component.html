<div class="space-y-4">
    {% include 'partials/_messages.html' %}
    <div>
        <label for="customer" class="block text-sm font-medium text-gray-700">Customer:</label>
        <select id="customer" u:model="customer"
            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
            <option value="">Select Customer</option>
            {% for customer in customers_list %}
            <option value="{{ customer.id }}">{{ customer.first_name }} {{ customer.last_name }}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label for="billing_address" class="block text-sm font-medium text-gray-700">Billing Address:</label>
        <textarea id="billing_address" u:model.lazy="billing_address" rows="3"
            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"></textarea>
    </div>
    <div>
        <label for="product_selected" class="block text-sm font-medium text-gray-700">Product:</label>
        <div class="flex space-x-2">
            <select id="product_selected" u:model.defer="product_selected"
                class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                <option value="">Select Product</option>
                {% for product in products_list %}
                <option value="{{ product.id }}">{{ product.name }}</option>
                {% endfor %}
            </select>
            <label for="product_quantity" class="block text-sm font-medium text-gray-700">Product Qty</label>
            <input type="number" id="product_quantity" u:model.defer="product_quantity" min="1" value="1"
                class="mt-1 block w-20 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">

            <label for="product_price" class="block text-sm font-medium text-gray-700">Product Price</label>
            <input type="number" id="product_price" u:model.defer="product_price" min="1" value="1"
                class="mt-1 block w-20 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">

            <label for="vat" class="block text-sm font-medium text-gray-700">VAT</label>
            <select name="vat" id="vat" u:model="product_vat"
                class="mt-1 block w-20 py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                {% for choice in vat_choices %}
                <option value="{{ choice }}">{{ choice }}</option>
                {% endfor %}
            </select>

            <button type="button" u:click="add_product"
                class="mt-1 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                Add Product
            </button>
        </div>
    </div>
<div class="relative overflow-x-auto shadow-md sm:rounded-lg">
    <h3 class="text-lg font-medium leading-6 text-gray-900 p-4">Selected Products</h3>
    <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
        <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
            <tr>
                <th scope="col" class="px-6 py-3">
                    Product Name
                </th>
                <th scope="col" class="px-6 py-3">
                    Quantity
                </th>
                <th scope="col" class="px-6 py-3">
                    Total Price
                </th>
                <th scope="col" class="px-6 py-3">
                    VAT % 
                </th>
                    <th scope="col" class="px-6 py-3">
                        VAT Amount
                    </th>
            </tr>
        </thead>
        <tbody>
            {% for item in selected_products %}
            <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
                <td class="px-6 py-4">
                    {{ item.product_name }}
                </td>
                <td class="px-6 py-4">
                    {{ item.quantity }}
                </td>
                <td class="px-6 py-4">
                    Rs. {{ item.total }}
                </td>

        <td class="px-6 py-4">
            {{ item.vat }} %
        </td>
        <td class="px-6 py-4">
            Rs. {{ item.vat_amount }}
        </td>

            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

    <div class="flex justify-between items-center">
        <h3 class="text-lg font-medium leading-6 text-gray-900">Total Amount: Rs{{ total_amount }}</h3>
        <h3 class="text-lg font-medium leading-6 text-gray-900">Total VAT: Rs {{ total_vat }}</h3>
        {% if customer %}
        <button u:click="create_invoice"
            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            Create Invoice
        </button>
        {% else %}
        <button disabled
            class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-gray-400 hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
            Create Invoice
        </button>
        {% endif %}
    </div>
</div>