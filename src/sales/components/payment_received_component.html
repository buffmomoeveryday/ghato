{% extends 'base.html' %}
{% load unicorn %}
{% block main %}
<h1 class="text-3xl font-bold pb-3 text-gray-800">Receive Payments</h1>
<span class="pb-4">
    <a href="{% url 'payments_received' %}" class=" underline hover:text-blue-600 ">List of Payments</a>
</span>

<div u:view>
    {% include 'partials/_messages.html' %}
    <div class="flex items-center mb-4">
        <input id="cash_payment" u:click="$toggle('cash_payment')" u:model="cash_payment" type="checkbox"
            class="form-checkbox h-5 w-5 text-blue-600">
        <label for="cash_payment" class="ml-2 text-gray-700">Cash</label>
    </div>

    <div class="mb-4">
        {% if cash_payment %}
        <select name="cash" id="cash" u:model="cash_id"
            class="form-select block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300">
            {% for account in cash_list %}
            <option value="{{ account.id }}">{{ account.name }}</option>
            {% endfor %}
        </select>
        {% else %}
        <select name="bank" id="bank" u:model="bank_id"
            class="form-select block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300">
            {% for account in bank_list %}
            <option value="{{ account.id }}">{{ account.name }}</option>
            {% endfor %}
        </select>
        {% endif %}
    </div>

    <div class="mb-4">
        <label for="customer" class="block text-gray-700 font-medium">Customer</label>
        <select u:model="customer_id" name="customer" id="customer"
            class="form-select block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300">
            <option value="" disabled selected>Select a customer</option>
            {% for customer in customer_list %}
            <option value="{{ customer.id }}">{{ customer.get_full_name }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-4">
        <span class="text-sm text-gray-600">Remaining Balance: <strong
                class="text-gray-800">{{ balance }}</strong></span>
    </div>

    <div class="mb-4">
        <label for="received_amount" class="block text-gray-700 font-medium">Received Amount</label>
        <input type="number" step="0.01" min="1" u:model.="received_amount" id="received_amount"
            class="form-input block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300" />
    </div>

    <div class="mb-4">
        <label for="transaction_id" class="block text-gray-700 font-medium">Transaction ID</label>
        <input  u:model.="transaction_id" u:change="check_txn_id" id="transaction_id"
            class="form-input block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300" />
    </div>

            <p>
                <span class="text-sm text-red-600">{{ unicorn.errors.transaction_id.0.message.0 }}</span>
            </p>

    <div class="mb-4">
        <label for="payment_method" class="block text-gray-700 font-medium">Payment Method</label>
        <input u:model.="payment_method" id="payment_method"
            class="form-input block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300" />
    </div>

    <div class="mb-4">
        <label for="payment_date" class="block text-gray-700 font-medium">Payment Date</label>
        <input type="date" u:input="validate_date" u:model.="payment_date" id="payment_date"
            class="form-input block w-full text-gray-700 bg-gray-100 border border-gray-300 rounded focus:ring focus:ring-blue-300" />
        <p>
            <span class="text-sm text-red-600">{{ unicorn.errors.payment_date.0.message }}</span>
        </p>
    </div>

    <div class="flex justify-end">
        <button type="button" u:click="add_payment"
            class="px-4 py-2 font-semibold rounded shadow focus:outline-none focus:ring-2 focus:ring-blue-300
                       {% if unicorn.errors %}bg-gray-600 text-white hover:bg-gray-700{% else %}bg-blue-600 text-white hover:bg-blue-700{% endif %}">
            Submit Payment
        </button>
    </div>
</div>
{% endblock main %}